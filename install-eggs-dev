#!/bin/bash
if command -v sudo >/dev/null 2>&1; then
    SUDO='sudo'
    SUSER="SUDO_USER"
else
    SUDO='doas'
    SUSER="DOAS_USER"    
fi
$SUDO cp scripts/eggs.bash /etc/bash_completion.d/eggs
$SUDO cp addons/eggs/adapt/bin/adapt /usr/local/bin/adapt
$SUDO cp g4/* /usr/local/bin
$SUDO cp assets/eggs.png /usr/share/icons/
$SUDO mkdir -p /usr/share/man/man1
$SUDO cp manpages/doc/man/eggs.1.gz /usr/share/man/man1

# rm /usr/bin/eggs and link it to sources
$SUDO rm -f /usr/bin/eggs
$SUDO ln -s ${HOME}/penguins-eggs/eggs /usr/bin/eggs

# if don't exists shutdown create it
if [ ! -e /usr/sbin/shutdown ]; then
# create a shutdown command
cat << 'EOF' > /tmp/shutdown
#!/usr/bin/env bash
/sbin/poweroff
EOF
$SUDO chmod +x /tmp/shutdown
$SUDO mv /tmp/shutdown /usr/sbin
fi

DESKTOP_DIR=$(xdg-user-dir DESKTOP)
cp addons/eggs/adapt/applications/eggs-adapt.desktop ${DESKTOP_DIR}
cp assets/penguins-eggs.desktop ${DESKTOP_DIR}

